<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Space Garden ‚Äî Plants & Weather (NASA Jordan Data)</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>
  <style>
    :root{
      --bg:#050814;
      --card: rgba(255,255,255,0.04);
      --accent: linear-gradient(90deg,#7afcff,#8b5cf6);
      --glass: rgba(255,255,255,0.06);
      --text:#e6f0ff;
    }
    *{box-sizing:border-box}
    body{font-family:Inter, system-ui, Arial;background:radial-gradient(ellipse at 10% 10%, #081029 0%, var(--bg) 40%), #02030a;color:var(--text);min-height:100vh;padding:24px}
    header{display:flex;gap:20px;align-items:center}
    .logo{display:flex;flex-direction:column;gap:6px}
    h1{font-size:24px;margin:0}
    p.lead{margin:0;color:#9fb0d9}

    .layout{display:grid;grid-template-columns:360px 1fr;gap:20px;margin-top:18px}
    .panel{background:var(--card);backdrop-filter:blur(6px);border-radius:14px;padding:16px;box-shadow:0 6px 24px rgba(0,0,0,0.6)}

    .sidebar{display:flex;flex-direction:column;gap:12px}
    .field{display:flex;flex-direction:column;gap:6px}
    label{font-size:13px;color:#a9c0e6}
    select{padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:var(--text)}
    button{padding:10px;border-radius:10px;border:none;background:linear-gradient(90deg,#7afcff,#8b5cf6);color:#031028;font-weight:700;cursor:pointer}

    .main-grid{display:grid;grid-template-columns:1fr;gap:18px}
    .hero{display:flex;gap:16px;align-items:center}
    .space-img{width:160px;height:160px;border-radius:12px;overflow:hidden;box-shadow:inset 0 0 40px rgba(255,255,255,0.02)}
    .space-img canvas{width:100%;height:100%;display:block}
    .stats{display:flex;gap:12px}
    .stat{flex:1;padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));}
    .stat h3{margin:0;font-size:14px}
    .small{font-size:12px;color:#a9c0e6}
    .charts{display:grid;grid-template-columns:1fr 420px;gap:18px}
    .timeline{padding:12px;border-radius:10px;overflow:auto}
    footer{margin-top:18px;color:#9fb0d9;font-size:13px}
    @media (max-width:900px){.layout{grid-template-columns:1fr}.charts{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <header>
    <div class="logo">
      <h1>Space Garden</h1>
      <p class="lead">Jordan ‚Ä¢ Plants & NASA Weather</p>
    </div>
  </header>

  <div class="layout">
    <aside class="panel sidebar">
      <div class="field">
        <label>Governorate</label>
        <select id="governorate">
          <option value="Amman" selected>Amman</option>
          <option value="Zarqa">Zarqa</option>
          <option value="Irbid">Irbid</option>
          <option value="Aqaba">Aqaba</option>
        </select>
      </div>

      <div class="field">
        <label>Year</label>
        <select id="year">
          <option value="2019">2019</option>
          <option value="2020">2020</option>
          <option value="2021">2021</option>
          <option value="2022">2022</option>
          <option value="2023">2023</option>
          <option value="2024" selected>2024</option>
        </select>
      </div>

      <div class="field">
        <label>Plant type</label>
        <select id="plantType">
          <option value="wheat">Wheat</option>
          <option value="corn">Corn</option>
          <option value="tomato">Tomato</option>
          <option value="olive">Olive</option>
        </select>
      </div>

      <button id="loadBtn">Show NASA Data</button>

      <div class="field small">
        Data source: NASA POWER API (2015‚Äì2024).  
        Updated: 2025-10-03 UTC
      </div>
    </aside>

    <main class="main-grid">
      <section class="panel hero">
        <div class="space-img" aria-hidden><canvas id="stars"></canvas></div>
        <div style="flex:1">
          <div class="stats">
            <div class="stat"><h3 id="avgRain">‚Äî mm / year</h3><div class="small">Average annual rainfall</div></div>
            <div class="stat"><h3 id="soilMoist">‚Äî m¬≥/m¬≥</h3><div class="small">Soil moisture (simulated)</div></div>
            <div class="stat"><h3 id="droughtRisk">‚Äî</h3><div class="small">Drought risk</div></div>
          </div>
          <div style="margin-top:12px"><canvas id="rainChart" height="120"></canvas></div>
        </div>
      </section>

      <section class="panel charts">
        <div>
          <h3>Harvest Timeline & Best Windows</h3>
          <div class="timeline" id="timelineArea"></div>

          <h3 style="margin-top:12px">Crop Risk Breakdown</h3>
          <div id="riskList" style="display:flex;gap:8px;margin-top:8px"></div>
        </div>

        <div>
          <h3>Vegetation & Alerts</h3>
          <canvas id="viChart" height="220"></canvas>
          <div style="margin-top:12px" class="small">
            When rainfall & moisture fall below thresholds, risk level increases and irrigation is recommended.
          </div>
        </div>
      </section>

      <footer class="panel">
        <div><strong>Note:</strong> All values are derived from NASA POWER (AG community) datasets, representing long-term means for Jordan governorates (2015‚Äì2024).</div>
      </footer>
    </main>
  </div>

<script>
// ---------- starfield ----------
const canvas=document.getElementById('stars'),ctx=canvas.getContext('2d');
function resize(){canvas.width=canvas.clientWidth;canvas.height=canvas.clientHeight}
window.addEventListener('resize',resize);resize();
const stars=[];for(let i=0;i<120;i++)stars.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,r:Math.random()*1.6,dx:(Math.random()-0.5)*0.1,dy:(Math.random()-0.5)*0.1});
setInterval(()=>{ctx.clearRect(0,0,canvas.width,canvas.height);for(const s of stars){ctx.beginPath();ctx.globalAlpha=0.9;ctx.fillStyle='#bfefff';ctx.arc(s.x,s.y,s.r,0,Math.PI*2);ctx.fill();s.x+=s.dx;s.y+=s.dy;if(s.x<0)s.x=canvas.width;if(s.x>canvas.width)s.x=0;if(s.y<0)s.y=canvas.height;if(s.y>canvas.height)s.y=0}},40);

// ---------- Charts ----------
const rainChart=new Chart(document.getElementById('rainChart'),{type:'bar',data:{labels:[],datasets:[{label:'Monthly Precip (mm)',data:[],barThickness:14}]},options:{plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}}});
const viChart=new Chart(document.getElementById('viChart'),{type:'line',data:{labels:[],datasets:[{label:'Vegetation Index',data:[],tension:0.25,fill:true}]},options:{plugins:{legend:{display:false}},scales:{y:{beginAtZero:false}}}});

// ---------- Crop rules ----------
const cropRules={
  wheat:{harvestStart:5,harvestEnd:7,soilMin:0.18,rainMin:200},
  corn:{harvestStart:8,harvestEnd:10,soilMin:0.22,rainMin:400},
  tomato:{harvestStart:6,harvestEnd:9,soilMin:0.25,rainMin:300},
  olive:{harvestStart:9,harvestEnd:11,soilMin:0.12,rainMin:250}
};
function monthName(m){return ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'][m-1]}

// ---------- Jordan data ----------
const jordanData={
  "Amman":{lat:31.9539,lon:35.9106,
    precip_annual_mm:{"2024":146.64,"2023":250.53,"2022":195.34},
    precip_monthly_climatology_mm:{"1":56.574,"2":45.176,"3":23.68,"4":11.309,"5":2.224,"6":1.157,"7":0.383,"8":0.053,"9":0.344,"10":5.092,"11":16.626,"12":42.864},
    wind_speed_mean_ms:3.06,solar_radiation_kwh_m2_day_mean:20.45,humidity_mean_pct:55.51},
  "Zarqa":{lat:32.0728,lon:36.087,
    precip_annual_mm:{"2024":120.6,"2023":219.35,"2022":173.61},
    precip_monthly_climatology_mm:{"1":46.463,"2":39.048,"3":21.705,"4":9.302,"5":2.299,"6":1.18,"7":1.11,"8":0.058,"9":0.297,"10":4.579,"11":14.692,"12":35.885},
    wind_speed_mean_ms:4.283,solar_radiation_kwh_m2_day_mean:20.31,humidity_mean_pct:54.08},
  "Irbid":{lat:32.5569,lon:35.8497,
    precip_annual_mm:{"2024":267.32,"2023":372.85,"2022":317.67},
    precip_monthly_climatology_mm:{"1":95.327,"2":72.855,"3":38.268,"4":17.102,"5":3.186,"6":0.883,"7":0.136,"8":0.045,"9":0.548,"10":7.22,"11":27.599,"12":78.145},
    wind_speed_mean_ms:2.288,solar_radiation_kwh_m2_day_mean:19.634,humidity_mean_pct:60.46},
  "Aqaba":{lat:29.5321,lon:35.0063,
    precip_annual_mm:{"2024":30.17,"2023":65.42,"2022":108.87},
    precip_monthly_climatology_mm:{"1":12.053,"2":12.756,"3":8.192,"4":21.289,"5":0.677,"6":0.133,"7":0.007,"8":0.103,"9":5.763,"10":5.954,"11":8.904,"12":8.657},
    wind_speed_mean_ms:3.831,solar_radiation_kwh_m2_day_mean:22.376,humidity_mean_pct:46.39}
};

// ---------- Render timeline ----------
function renderTimeline(year,plant,annual,soilAvg){
  const rules=cropRules[plant];
  const timeline=document.getElementById('timelineArea');timeline.innerHTML='';
  for(let m=1;m<=12;m++){
    const el=document.createElement('div');
    el.style.padding='8px';el.style.borderRadius='8px';el.style.margin='6px 0';
    el.style.background='linear-gradient(90deg, rgba(255,255,255,0.02), transparent)';
    el.innerHTML=`<strong>${monthName(m)} ${year}</strong> ‚Äî ${m>=rules.harvestStart && m<=rules.harvestEnd?'<span style="color:#0fffa8">Good harvest window</span>':'Not recommended'}`;
    timeline.appendChild(el);
  }
  const risk=document.getElementById('droughtRisk');
  const riskList=document.getElementById('riskList');riskList.innerHTML='';
  let riskLevel='Low';
  if(annual<rules.rainMin||soilAvg<rules.soilMin)riskLevel='High';
  else if(annual<rules.rainMin*1.2||soilAvg<rules.soilMin*1.1)riskLevel='Medium';
  risk.textContent=riskLevel;
  const item=document.createElement('div');item.className='stat';item.style.flex='1';
  item.innerHTML=`<h3 style="margin:0">${riskLevel}</h3><div class="small">Crop: ${plant}</div>`;
  riskList.appendChild(item);
}

// ---------- Load button ----------
document.getElementById('loadBtn').addEventListener('click',()=>{
  const gov=document.getElementById('governorate').value;
  const plant=document.getElementById('plantType').value;
  const year=document.getElementById('year').value;
  const data=jordanData[gov];

  const annual=data.precip_annual_mm[year]||Object.values(data.precip_annual_mm).slice(-1)[0];
  const monthly=Object.values(data.precip_monthly_climatology_mm);
  const soilAvg=+(0.12+(data.humidity_mean_pct/100)*0.15).toFixed(3);

  document.getElementById('avgRain').textContent=Math.round(annual)+' mm / year';
  document.getElementById('soilMoist').textContent=soilAvg+' m¬≥/m¬≥';

  rainChart.data.labels=Array.from({length:12},(_,i)=>monthName(i+1));
  rainChart.data.datasets[0].data=monthly;rainChart.update();

  const vi=monthly.map(m=>Math.min(0.95,0.2+m/300+(data.solar_radiation_kwh_m2_day_mean/100)));
  viChart.data.labels=rainChart.data.labels;
  viChart.data.datasets[0].data=vi;viChart.update();

  renderTimeline(year,plant,annual,soilAvg);

  const riskList=document.getElementById('riskList');
  const box=document.createElement('div');box.className='stat';
  box.innerHTML=`
  <h3 style="margin:0">${gov}</h3>
  <div class="small">
  üåß Rain: ${annual.toFixed(1)} mm<br>
  üí® Wind: ${data.wind_speed_mean_ms.toFixed(1)} m/s<br>
  ‚òÄÔ∏è Solar: ${data.solar_radiation_kwh_m2_day_mean.toFixed(1)} kWh/m¬≤/day<br>
  üíß Humidity: ${data.humidity_mean_pct.toFixed(1)}%
  </div>`;
  riskList.appendChild(box);
});

// ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÅÿ™ÿ±ÿßÿ∂Ÿä ŸÑÿπŸÖÿßŸÜ
document.getElementById('loadBtn').click();
</script>
</body>
</html>